<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Webhook & Discord Bot Interactions</title>
  <style>
    body {
      background-color: #000000;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }

    input, button, select {
      padding: 10px;
      margin: 5px;
      background-color: #333;
      color: white;
      border: 1px solid #666;
    }

    button:hover, select:hover {
      background-color: #555;
    }

    .tab-content {
      display: none;
    }

    .active-tab {
      display: block;
    }

    .mode-toggle {
      margin-top: 20px;
      padding: 10px;
      background-color: #444;
      cursor: pointer;
      border: 1px solid #666;
    }

    .mode-toggle:hover {
      background-color: #555;
    }

    .log-section {
      margin-bottom: 20px;
    }

    .log-header {
      font-size: 18px;
      margin-top: 10px;
    }

    #permissions-panel {
      display: none;
    }

    .permissions-options {
      margin: 10px;
    }
  </style>
</head>
<body>
  <h1>Webhook & Discord Bot Interactions</h1>

  <div>
    <button class="mode-toggle" onclick="switchTab('webhook-tab')">Webhook Tab</button>
    <button class="mode-toggle" onclick="switchTab('bot-tab')">Discord Bot Tab</button>
  </div>

  <!-- Webhook Tab -->
  <div id="webhook-tab" class="tab-content active-tab">
    <h2>Webhook Tab</h2>
    <label for="webhook">Enter Webhook URL:</label>
    <input type="text" id="webhook" placeholder="Enter your webhook URL">
    <label for="message">Custom Message:</label>
    <input type="text" id="webhook-message" placeholder="Enter your message">
    <button onclick="sendWebhook()">Send Message</button>

    <div class="message-log" id="webhook-log">
      <h3>Webhook Log</h3>
      <div class="log-section" id="webhook-success-log">
        <h4 class="log-header">Successful Webhooks</h4>
        <pre id="webhook-success-log-content">No successful logs yet.</pre>
      </div>
      <div class="log-section" id="webhook-fail-log">
        <h4 class="log-header">Failed Webhooks</h4>
        <pre id="webhook-fail-log-content">No failed logs yet.</pre>
      </div>
    </div>
  </div>

  <!-- Discord Bot Tab -->
  <div id="bot-tab" class="tab-content">
    <h2>Discord Bot Tab</h2>
    <label for="bot-token">Enter Bot Token:</label>
    <input type="text" id="bot-token" placeholder="Enter your bot token">
    <button onclick="checkBotPermissions()">Check Permissions</button>

    <div id="permissions-panel">
      <h3>Bot Permissions</h3>
      <div id="permissions-list"></div>
      
      <div class="permissions-options">
        <label for="channel-select">Select Channel to Send Message:</label>
        <select id="channel-select">
          <option value="">-- Select Channel --</option>
        </select>
      </div>
      
      <div class="permissions-options">
        <label for="send-message">Send Message to Channel:</label>
        <input type="text" id="send-message" placeholder="Enter message to send">
        <button onclick="sendMessage()">Send Message</button>
      </div>
      
      <div class="permissions-options">
        <label for="read-messages">Read Last 10 Messages:</label>
        <button onclick="readMessages()">Read Messages</button>
      </div>
    </div>

    <div id="bot-log">
      <h3>Bot Log</h3>
      <div id="bot-log-content">No bot actions yet.</div>
    </div>
  </div>

  <script>
    // Switch between tabs (Webhook & Bot)
    function switchTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active-tab');
      });
      document.getElementById(tabId).classList.add('active-tab');
    }

    // Webhook sending and logging
    async function sendWebhook() {
      const webhookUrl = document.getElementById('webhook').value;
      const message = document.getElementById('webhook-message').value;
      
      const result = await sendWebhookToRandomized(webhookUrl, message);
      const successLogContent = document.getElementById('webhook-success-log-content');
      const failLogContent = document.getElementById('webhook-fail-log-content');
      
      if (result.success) {
        successLogContent.textContent += `Success: Webhook ${webhookUrl} was successful!\n`;
      } else {
        failLogContent.textContent += `Failed: Webhook ${webhookUrl} failed.\n`;
      }
    }

    // Function to send webhook message
    async function sendWebhookToRandomized(webhook, message) {
      try {
        const response = await fetch(webhook, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ content: message })
        });
        if (response.status === 204) {
          return { success: true };
        } else {
          return { success: false };
        }
      } catch (error) {
        return { success: false };
      }
    }

    // Discord Bot Permissions Check
    async function checkBotPermissions() {
      const botToken = document.getElementById('bot-token').value;
      
      if (!botToken) {
        alert('Please enter a valid bot token.');
        return;
      }

      const result = await fetchBotPermissions(botToken);
      
      if (result.success) {
        const permissionsList = document.getElementById('permissions-list');
        const channelSelect = document.getElementById('channel-select');
        
        permissionsList.innerHTML = `
          <p>Bot Permissions: ${result.permissions.join(', ')}</p>
        `;
        
        // Populate channel options (example data)
        channelSelect.innerHTML = '';
        result.channels.forEach(channel => {
          const option = document.createElement('option');
          option.value = channel.id;
          option.textContent = channel.name;
          channelSelect.appendChild(option);
        });

        document.getElementById('permissions-panel').style.display = 'block';
      } else {
        alert('Failed to fetch bot permissions.');
      }
    }

    // Fetch bot permissions from Discord API
    async function fetchBotPermissions(botToken) {
      try {
        const response = await fetch(`https://discord.com/api/v10/users/@me`, {
          method: 'GET',
          headers: { 'Authorization': `Bot ${botToken}` },
        });

        const data = await response.json();

        if (data.id) {
          // Example response for channels and permissions
          return {
            success: true,
            permissions: ['SEND_MESSAGES', 'READ_MESSAGES'],
            channels: [
              { id: '123456789012345678', name: 'general' },
              { id: '987654321098765432', name: 'announcements' },
            ],
          };
        } else {
          return { success: false };
        }
      } catch (error) {
        return { success: false };
      }
    }

    // Send message to a selected channel (Bot)
    async function sendMessage() {
      const botToken = document.getElementById('bot-token').value;
      const message = document.getElementById('send-message').value;
      const channelId = document.getElementById('channel-select').value;
      
      if (!channelId || !message) {
        alert('Please select a channel and enter a message.');
        return;
      }

      const result = await sendBotMessage(botToken, channelId, message);
      
      if (result.success) {
        document.getElementById('bot-log-content').textContent = `Message sent to channel ${channelId}.`;
      } else {
        document.getElementById('bot-log-content').textContent = `Failed to send message.`;
      }
    }

    // Send bot message to a channel
    async function sendBotMessage(botToken, channelId, message) {
      try {
        const response = await fetch(`https://discord.com/api/v10/channels/${channelId}/messages`, {
          method: 'POST',
          headers: {
            'Authorization': `Bot ${botToken}`,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ content: message }),
        });

        if (response.status === 200) {
          return { success: true };
        } else {
          return { success: false };
        }
      } catch (error) {
        return { success: false };
      }
    }

    // Read the last 10 messages from a channel
    async function readMessages() {
      const botToken = document.getElementById('bot-token').value;
      const channelId = document.getElementById('channel-select').value;
      
      if (!channelId) {
        alert('Please select a channel to read messages.');
        return;
      }

      const result = await fetchMessages(botToken, channelId);
      
      if (result.success) {
        document.getElementById('bot-log-content').textContent = `Last 10 messages from channel ${channelId}: ${result.messages.join(', ')}`;
      } else {
        document.getElementById('bot-log-content').textContent = `Failed to read messages.`;
      }
    }

    // Fetch last 10 messages from a channel
    async function fetchMessages(botToken, channelId) {
      try {
        const response = await fetch(`https://discord.com/api/v10/channels/${channelId}/messages?limit=10`, {
          method: 'GET',
          headers: { 'Authorization': `Bot ${botToken}` },
        });

        const data = await response.json();
        
        if (data.length > 0) {
          const messages = data.map(msg => msg.content);
          return { success: true, messages };
        } else {
          return { success: false };
        }
      } catch (error) {
        return { success: false };
      }
    }
  </script>
</body>
</html>
